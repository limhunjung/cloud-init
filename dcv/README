#ubuntu 20.04 
#apt install --no-install-recommends lxde -y
sudo apt update && sudo apt install --no-install-recommends ubuntu-desktop mesa-utils -y




#디스플레이 메니져 변경 (ubuntu 18이상은 gdm3 only)
sudo apt install -y gdm3
sudo sed -ie 's/#WaylandEnable=false/WaylandEnable=false/' /etc/gdm3/custom.conf #dcv
sudo systemctl restart gdm3
reboot  #필수

#ubuntu 22.04

scp katech@10.10.17.20:/home/katech/cloud-init/nice-dcv-2024.0-17979-ubuntu2004-x86_64.tgz ./

tar zxvf nice-dcv-*ubun*.tgz
cd nice-dcv-*64
apt install -y ./nice-*amd64.ubuntu*.deb

scp katech@10.10.17.20:/home/katech/cloud-init/dcv.conf /etc/dcv/dcv.conf

usermod -aG video dcv



# dcvgldiag  #Diagnostic Script
#에러 무시 
 
sudo systemctl isolate graphical.target   #GUI
sudo systemctl isolate multi-user.target  #CLI 
sudo systemctl get-default  #확인 
sudo systemctl set-default multi-user.target #고정, GPU없고, GUI
sudo systemctl set-default graphical.target #고정, GPU있고, GUI



sudo systemctl enable dcvserver
sudo systemctl start dcvserver
sudo dcv create-session --owner kadap kadap   #rc.local에 추가 (필수!!!)
 
 dcv list-sessions
 
 
#?root 로그인
#lxde에서 화면 작음 

# 서비스 등록 
sudo tar -xvf sessionctl.tar -C /opt/


"""
sessionctl.tar파일을 /opt/폴더 아래에서 tar파일 압축을 해제하시면 될것같습니다.

현재는 시간설정을 5분으로 설정하여서 cfg파일을 수정하시면 안됩니다.

1시간 아래의 시간을 설정할때는 

sessionctl.sh 파일의 

#LIMITSEC=$(expr ${LIMITTIME} \* 60 \* 60)
LIMITSEC=$(expr ${LIMITTIME} \* 300)

이부분의 300으로 설정되어있는 부분을 수정하시면 됩니다. 현재 5분으로 설정되어있습니다.

vi /etc/dcv/dcvsessioninit 파일을 수정합니다

/opt/nice/isbc/sessionctl.sh &  를 추가해주시면됩니다.
"""

